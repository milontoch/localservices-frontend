(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[394],{5535:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/blog",function(){return a(8293)}])},8293:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return o}});var l=a(5893),s=a(7294),n=a(1163),i=a(9008),r=a.n(i),c=a(9871),d=a(8561);function o(){let e=(0,n.useRouter)(),[t,a]=(0,s.useState)([]),[i,o]=(0,s.useState)(!0),[u,m]=(0,s.useState)(""),[x,h]=(0,s.useState)(!1),[p,g]=(0,s.useState)({title:"",slug:"",content:"",featured_image_url:""});(0,s.useEffect)(()=>{let t=(0,d.PR)();if(!t||"admin"!==t.role){e.push("/auth/login");return}b()},[e]);let b=async()=>{try{let e=await (0,d.V)();a(e.data)}catch(e){m("Failed to load blog posts")}finally{o(!1)}},f=async e=>{e.preventDefault(),m("");try{let e=new FormData;e.append("title",p.title),e.append("slug",p.slug),e.append("content",p.content),p.featured_image_url&&e.append("featured_image_url",p.featured_image_url),await (0,d.bl)(e),g({title:"",slug:"",content:"",featured_image_url:""}),h(!1),b(),alert("Blog post created")}catch(e){var t,a;m((null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.errors)?Object.values(e.response.data.errors).flat().join(", "):"Failed to create blog post")}},j=async e=>{if(confirm("Delete this blog post? This action cannot be undone."))try{await (0,d.xQ)(e),a(t.filter(t=>t.id!==e)),alert("Blog post deleted")}catch(e){alert("Failed to delete blog post")}},N=e=>e.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim();return i?(0,l.jsx)(c.Z,{children:(0,l.jsx)("div",{className:"container mx-auto px-4 py-16 text-center",children:(0,l.jsx)("p",{children:"Loading..."})})}):(0,l.jsxs)(c.Z,{children:[(0,l.jsx)(r(),{children:(0,l.jsx)("title",{children:"Blog Management - Admin"})}),(0,l.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold",children:"Blog Management"}),(0,l.jsx)("button",{onClick:()=>h(!x),className:"btn-primary",children:x?"Cancel":"Create New Post"})]}),u&&(0,l.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:u}),x&&(0,l.jsxs)("div",{className:"card mb-6",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Create Blog Post"}),(0,l.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Title"}),(0,l.jsx)("input",{type:"text",value:p.title,onChange:e=>{g({...p,title:e.target.value,slug:N(e.target.value)})},className:"input-field",required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Slug"}),(0,l.jsx)("input",{type:"text",value:p.slug,onChange:e=>g({...p,slug:e.target.value}),className:"input-field",required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Featured Image URL"}),(0,l.jsx)("input",{type:"url",value:p.featured_image_url,onChange:e=>g({...p,featured_image_url:e.target.value}),className:"input-field",placeholder:"https://example.com/image.jpg"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Content"}),(0,l.jsx)("textarea",{value:p.content,onChange:e=>g({...p,content:e.target.value}),className:"input-field",rows:"10",required:!0})]}),(0,l.jsx)("button",{type:"submit",className:"btn-primary",children:"Publish Post"})]})]}),(0,l.jsx)("div",{className:"space-y-4",children:t.map(t=>(0,l.jsx)("div",{className:"card",children:(0,l.jsxs)("div",{className:"flex justify-between items-start",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h3",{className:"text-xl font-semibold mb-2",children:t.title}),(0,l.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["Slug: ",t.slug]}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["Published: ",new Date(t.created_at).toLocaleDateString()]})]}),(0,l.jsxs)("div",{className:"flex gap-2 ml-4",children:[(0,l.jsx)("button",{onClick:()=>e.push("/blog/".concat(t.slug)),className:"text-primary-600 hover:underline",children:"View"}),(0,l.jsx)("button",{onClick:()=>j(t.id),className:"text-red-600 hover:underline",children:"Delete"})]})]})},t.id))})]})]})}}},function(e){e.O(0,[173,871,774,888,179],function(){return e(e.s=5535)}),_N_E=e.O()}]);