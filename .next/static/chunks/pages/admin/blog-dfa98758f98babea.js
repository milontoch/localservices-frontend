(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[394],{5535:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/blog",function(){return n(8293)}])},9871:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(5893),a=n(1664),s=n.n(a),l=n(1163),i=n(7294),c=n(8561);function o(e){let{children:t}=e,n=(0,l.useRouter)(),[a,o]=(0,i.useState)(null);return(0,i.useEffect)(()=>{o((0,c.PR)())},[]),(0,r.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,r.jsx)("nav",{className:"bg-white shadow-md",children:(0,r.jsx)("div",{className:"container mx-auto px-4",children:(0,r.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,r.jsx)(s(),{href:"/",className:"text-2xl font-bold text-primary-600",children:"LocalServices"}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)(s(),{href:"/blog",className:"text-gray-700 hover:text-primary-600",children:"Blog"}),a?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("span",{className:"text-gray-700",children:["Hi, ",a.full_name||a.name]}),(0,r.jsx)("button",{onClick:()=>{(0,c.H6)(),(0,c.kX)(),o(null),n.push("/")},className:"btn-secondary",children:"Logout"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s(),{href:"/auth/login",className:"text-gray-700 hover:text-primary-600",children:"Login"}),(0,r.jsx)(s(),{href:"/auth/register",className:"btn-primary",children:"Sign Up"}),(0,r.jsx)(s(),{href:"/provider/register",className:"btn-secondary",children:"Register as Provider"})]})]})]})})}),(0,r.jsx)("main",{className:"flex-grow",children:t})]})}},8293:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return u}});var r=n(5893),a=n(7294),s=n(1163),l=n(9008),i=n.n(l),c=n(9871),o=n(8561);function u(){let e=(0,s.useRouter)(),[t,n]=(0,a.useState)([]),[l,u]=(0,a.useState)(!0),[d,m]=(0,a.useState)(""),[x,g]=(0,a.useState)(!1),[h,f]=(0,a.useState)({title:"",slug:"",content:"",featured_image_url:""});(0,a.useEffect)(()=>{let t=(0,o.PR)();if(!t||"admin"!==t.role){e.push("/auth/login");return}p()},[e]);let p=async()=>{try{let e=await (0,o.V)();n(e.data)}catch(e){m("Failed to load blog posts")}finally{u(!1)}},b=async e=>{e.preventDefault(),m("");try{let e=new FormData;e.append("title",h.title),e.append("slug",h.slug),e.append("content",h.content),h.featured_image_url&&e.append("featured_image_url",h.featured_image_url),await (0,o.bl)(e),f({title:"",slug:"",content:"",featured_image_url:""}),g(!1),p(),alert("Blog post created")}catch(e){var t,n;m((null===(n=e.response)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.errors)?Object.values(e.response.data.errors).flat().join(", "):"Failed to create blog post")}},v=async e=>{if(confirm("Delete this blog post? This action cannot be undone."))try{await (0,o.xQ)(e),n(t.filter(t=>t.id!==e)),alert("Blog post deleted")}catch(e){alert("Failed to delete blog post")}},j=e=>e.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim();return l?(0,r.jsx)(c.Z,{children:(0,r.jsx)("div",{className:"container mx-auto px-4 py-16 text-center",children:(0,r.jsx)("p",{children:"Loading..."})})}):(0,r.jsxs)(c.Z,{children:[(0,r.jsx)(i(),{children:(0,r.jsx)("title",{children:"Blog Management - Admin"})}),(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold",children:"Blog Management"}),(0,r.jsx)("button",{onClick:()=>g(!x),className:"btn-primary",children:x?"Cancel":"Create New Post"})]}),d&&(0,r.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:d}),x&&(0,r.jsxs)("div",{className:"card mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Create Blog Post"}),(0,r.jsxs)("form",{onSubmit:b,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Title"}),(0,r.jsx)("input",{type:"text",value:h.title,onChange:e=>{f({...h,title:e.target.value,slug:j(e.target.value)})},className:"input-field",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Slug"}),(0,r.jsx)("input",{type:"text",value:h.slug,onChange:e=>f({...h,slug:e.target.value}),className:"input-field",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Featured Image URL"}),(0,r.jsx)("input",{type:"url",value:h.featured_image_url,onChange:e=>f({...h,featured_image_url:e.target.value}),className:"input-field",placeholder:"https://example.com/image.jpg"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Content"}),(0,r.jsx)("textarea",{value:h.content,onChange:e=>f({...h,content:e.target.value}),className:"input-field",rows:"10",required:!0})]}),(0,r.jsx)("button",{type:"submit",className:"btn-primary",children:"Publish Post"})]})]}),(0,r.jsx)("div",{className:"space-y-4",children:t.map(t=>(0,r.jsx)("div",{className:"card",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold mb-2",children:t.title}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["Slug: ",t.slug]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Published: ",new Date(t.created_at).toLocaleDateString()]})]}),(0,r.jsxs)("div",{className:"flex gap-2 ml-4",children:[(0,r.jsx)("button",{onClick:()=>e.push("/blog/".concat(t.slug)),className:"text-primary-600 hover:underline",children:"View"}),(0,r.jsx)("button",{onClick:()=>v(t.id),className:"text-red-600 hover:underline",children:"Delete"})]})]})},t.id))})]})]})}},8561:function(e,t,n){"use strict";n.d(t,{CP:function(){return d},H6:function(){return B},J8:function(){return _},J9:function(){return m},Ji:function(){return C},Mu:function(){return u},NI:function(){return f},NN:function(){return k},PR:function(){return E},SK:function(){return S},V:function(){return j},VH:function(){return x},XU:function(){return g},av:function(){return R},bW:function(){return L},bl:function(){return N},dS:function(){return h},k4:function(){return P},kX:function(){return T},oO:function(){return p},sv:function(){return w},t1:function(){return o},u3:function(){return b},uB:function(){return I},wd:function(){return i},x4:function(){return c},xQ:function(){return y},z2:function(){return l},zl:function(){return v}});var r=n(7066);let a=n(3454).env.NEXT_PUBLIC_API_URL||"http://localhost:8000/api/v1",s=r.Z.create({baseURL:a,headers:{"Content-Type":"application/json"}});s.interceptors.request.use(e=>{let t=localStorage.getItem("access_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e));let l=e=>s.post("/auth/register",e),i=e=>s.post("/auth/register-provider",e),c=e=>s.post("/auth/login",e),o=e=>s.post("/auth/request-otp",e),u=e=>s.post("/auth/verify-otp",e),d=()=>s.get("/categories"),m=e=>s.get("/providers",{params:e}),x=e=>s.get("/providers/".concat(e)),g=e=>s.post("/reviews",e),h=e=>s.post("/contact-records",e),f=e=>s.get("/contact-records/check",{params:e}),p=e=>s.post("/verifications",e,{headers:{"Content-Type":"multipart/form-data"}}),b=e=>s.get("/blog",{params:e}),v=e=>s.get("/blog/".concat(e)),j=()=>s.get("/admin/blog"),N=e=>s.post("/admin/blog",e,{headers:{"Content-Type":"multipart/form-data"}}),y=e=>s.delete("/admin/blog/".concat(e)),_=()=>s.get("/admin/verifications"),w=(e,t)=>s.put("/admin/verifications/".concat(e),t),S=e=>s.get("/admin/users",{params:e}),k=e=>s.get("/admin/providers",{params:e}),C=e=>s.get("/admin/reviews",{params:e}),P=e=>s.delete("/admin/reviews/".concat(e)),I=e=>{localStorage.setItem("access_token",e)},L=()=>localStorage.getItem("access_token"),B=()=>{localStorage.removeItem("access_token")},R=e=>{localStorage.setItem("user",JSON.stringify(e))},E=()=>{let e=localStorage.getItem("user");return e?JSON.parse(e):null},T=()=>{localStorage.removeItem("user")}}},function(e){e.O(0,[173,774,888,179],function(){return e(e.s=5535)}),_N_E=e.O()}]);