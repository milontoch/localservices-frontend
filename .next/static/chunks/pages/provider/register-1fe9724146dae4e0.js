(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[825],{9532:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/provider/register",function(){return a(4727)}])},4727:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var r=a(5893),s=a(7294),n=a(1163),i=a(9008),l=a.n(i),o=a(1664),d=a.n(o),c=a(9871),u=a(8561),m=a(8806);function p(){let e=(0,n.useRouter)(),[t,a]=(0,s.useState)(1),[i,o]=(0,s.useState)([]),[p,x]=(0,s.useState)({full_name:"",email:"",phone_number:"",password:"",confirmPassword:"",category_id:"",experience_years:1,address:""}),[h,f]=(0,s.useState)(""),[v,b]=(0,s.useState)(null),[g,y]=(0,s.useState)(""),[j,N]=(0,s.useState)(!1),[_,w]=(0,s.useState)(null);(0,s.useEffect)(()=>{P()},[]);let P=async()=>{try{let e=await (0,u.CP)();o(e.data)}catch(e){console.error("Error fetching categories:",e)}},C=async e=>{if(e.preventDefault(),y(""),p.password!==p.confirmPassword){y("Passwords do not match");return}N(!0);try{let e={lat:null,lng:null};p.address&&(e=await (0,m.g)(p.address)||e);let t=await (0,u.wd)({full_name:p.full_name,email:p.email,phone_number:p.phone_number,password:p.password,category_id:p.category_id,experience_years:p.experience_years,latitude:e.lat,longitude:e.lng});w(t.data.provider.id),await (0,u.t1)({phone_number:p.phone_number,user_type:"provider"}),a(2)}catch(e){var t,r;y((null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.errors)?Object.values(e.response.data.errors).flat().join(", "):"Registration failed")}finally{N(!1)}},k=async e=>{e.preventDefault(),y(""),N(!0);try{let e=await (0,u.Mu)({phone_number:p.phone_number,otp:h,user_type:"provider"});(0,u.uB)(e.data.access_token),(0,u.av)(e.data.user),a(3)}catch(e){var t,r;y((null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.error)||"OTP verification failed")}finally{N(!1)}},S=async t=>{if(t.preventDefault(),y(""),!v){y("Please select a verification document");return}N(!0);try{let t=new FormData;t.append("provider_id",_),t.append("document",v),await (0,u.oO)(t),alert("Verification document uploaded! Your account will be reviewed by an admin."),e.push("/")}catch(e){var a,r;y((null===(r=e.response)||void 0===r?void 0:null===(a=r.data)||void 0===a?void 0:a.error)||"Upload failed")}finally{N(!1)}};return(0,r.jsxs)(c.Z,{children:[(0,r.jsx)(l(),{children:(0,r.jsx)("title",{children:"Register as Provider - LocalServices"})}),(0,r.jsx)("div",{className:"container mx-auto px-4 py-16",children:(0,r.jsxs)("div",{className:"max-w-2xl mx-auto card",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-6 text-center",children:"Become a Service Provider"}),(0,r.jsxs)("div",{className:"flex justify-between mb-8",children:[(0,r.jsx)("div",{className:"flex-1 text-center ".concat(t>=1?"text-primary-600 font-semibold":"text-gray-400"),children:"1. Register"}),(0,r.jsx)("div",{className:"flex-1 text-center ".concat(t>=2?"text-primary-600 font-semibold":"text-gray-400"),children:"2. Verify Phone"}),(0,r.jsx)("div",{className:"flex-1 text-center ".concat(t>=3?"text-primary-600 font-semibold":"text-gray-400"),children:"3. Upload ID"})]}),g&&(0,r.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:g}),1===t&&(0,r.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Full Name"}),(0,r.jsx)("input",{type:"text",value:p.full_name,onChange:e=>x({...p,full_name:e.target.value}),className:"input-field",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Email"}),(0,r.jsx)("input",{type:"email",value:p.email,onChange:e=>x({...p,email:e.target.value}),className:"input-field",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Phone Number"}),(0,r.jsx)("input",{type:"tel",value:p.phone_number,onChange:e=>x({...p,phone_number:e.target.value}),className:"input-field",placeholder:"+2348012345678",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Service Category"}),(0,r.jsxs)("select",{value:p.category_id,onChange:e=>x({...p,category_id:e.target.value}),className:"input-field",required:!0,children:[(0,r.jsx)("option",{value:"",children:"Select category"}),i.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Years of Experience"}),(0,r.jsx)("input",{type:"number",min:"0",value:p.experience_years,onChange:e=>x({...p,experience_years:parseInt(e.target.value)}),className:"input-field",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Address"}),(0,r.jsx)("input",{type:"text",value:p.address,onChange:e=>x({...p,address:e.target.value}),className:"input-field",placeholder:"Enter your address"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Password"}),(0,r.jsx)("input",{type:"password",value:p.password,onChange:e=>x({...p,password:e.target.value}),className:"input-field",minLength:"6",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Confirm Password"}),(0,r.jsx)("input",{type:"password",value:p.confirmPassword,onChange:e=>x({...p,confirmPassword:e.target.value}),className:"input-field",required:!0})]})]}),(0,r.jsx)("button",{type:"submit",disabled:j,className:"btn-primary w-full",children:j?"Registering...":"Continue"})]}),2===t&&(0,r.jsxs)("form",{onSubmit:k,className:"space-y-4",children:[(0,r.jsxs)("p",{className:"text-center text-gray-600 mb-4",children:["We've sent a verification code to ",p.phone_number]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Enter OTP"}),(0,r.jsx)("input",{type:"text",value:h,onChange:e=>f(e.target.value),className:"input-field text-center text-2xl tracking-widest",maxLength:"6",pattern:"[0-9]{6}",placeholder:"000000",required:!0})]}),(0,r.jsx)("button",{type:"submit",disabled:j,className:"btn-primary w-full",children:j?"Verifying...":"Verify OTP"})]}),3===t&&(0,r.jsxs)("form",{onSubmit:S,className:"space-y-4",children:[(0,r.jsx)("p",{className:"text-center text-gray-600 mb-4",children:"Upload a government-issued ID or business license for verification"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Verification Document"}),(0,r.jsx)("input",{type:"file",accept:"image/*,.pdf",onChange:e=>b(e.target.files[0]),className:"input-field",required:!0}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Accepted formats: JPG, PNG, PDF (Max 5MB)"})]}),(0,r.jsx)("button",{type:"submit",disabled:j,className:"btn-primary w-full",children:j?"Uploading...":"Submit for Verification"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 text-center",children:"Your account will be reviewed by our team within 24-48 hours"})]}),(0,r.jsx)("div",{className:"mt-6 text-center",children:(0,r.jsxs)("p",{className:"text-gray-600",children:["Already have an account?"," ",(0,r.jsx)(d(),{href:"/auth/login",className:"text-primary-600 hover:underline",children:"Login"})]})})]})})]})}},8806:function(e,t,a){"use strict";a.d(t,{g:function(){return n},v:function(){return i}});var r=a(7066);let s=a(3454).env.NEXT_PUBLIC_MAPBOX_KEY,n=async e=>{try{let t=await r.Z.get("https://api.mapbox.com/geocoding/v5/mapbox.places/".concat(encodeURIComponent(e),".json"),{params:{access_token:s,limit:1}});if(t.data.features.length>0){let[e,a]=t.data.features[0].center;return{lat:a,lng:e}}return null}catch(e){return console.error("Geocoding error:",e),null}},i=()=>new Promise((e,t)=>{if(!navigator.geolocation){t(Error("Geolocation not supported"));return}navigator.geolocation.getCurrentPosition(t=>{e({lat:t.coords.latitude,lng:t.coords.longitude})},e=>t(e))})}},function(e){e.O(0,[173,871,774,888,179],function(){return e(e.s=9532)}),_N_E=e.O()}]);