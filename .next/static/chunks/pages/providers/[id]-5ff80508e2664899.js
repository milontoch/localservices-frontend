(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[916],{6650:function(e,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/providers/[id]",function(){return a(9371)}])},9371:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return u}});var t=a(5893),l=a(7294),i=a(1163),r=a(9008),n=a.n(r),c=a(5675),o=a.n(c),d=a(9871),m=a(1782),x=a(8561);function u(){var e;let s=(0,i.useRouter)(),{id:a}=s.query,[r,c]=(0,l.useState)(null),[u,h]=(0,l.useState)(!0),[p,v]=(0,l.useState)(!1),[j,f]=(0,l.useState)(!1),[b,N]=(0,l.useState)({rating:5,comment:""}),[g,y]=(0,l.useState)(!1);(0,l.useEffect)(()=>{a&&(w(),_())},[a]);let w=async()=>{try{let e=await (0,x.VH)(a);c(e.data)}catch(e){console.error("Error fetching provider:",e)}finally{h(!1)}},_=async()=>{if((0,x.bW)())try{let e=await (0,x.NI)({provider_id:a});v(e.data.has_contacted)}catch(e){console.error("Error checking contact:",e)}},C=async e=>{if(!(0,x.bW)()){s.push("/auth/login");return}try{await (0,x.dS)({provider_id:a}),v(!0),"call"===e?window.location.href="tel:".concat(r.phone_number):"whatsapp"===e&&window.open("https://wa.me/".concat(r.phone_number.replace("+",""),"?text=Hi"),"_blank")}catch(e){console.error("Error recording contact:",e)}},k=async e=>{if(e.preventDefault(),!(0,x.bW)()){s.push("/auth/login");return}y(!0);try{await (0,x.XU)({provider_id:a,...b}),alert("Review submitted successfully!"),f(!1),w()}catch(e){var t,l;alert((null===(l=e.response)||void 0===l?void 0:null===(t=l.data)||void 0===t?void 0:t.error)||"Error submitting review")}finally{y(!1)}};return u?(0,t.jsx)(d.Z,{children:(0,t.jsx)("div",{className:"container mx-auto px-4 py-8 text-center",children:"Loading..."})}):r?(0,t.jsxs)(d.Z,{children:[(0,t.jsx)(n(),{children:(0,t.jsxs)("title",{children:[r.full_name," - LocalServices"]})}),(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,t.jsx)("div",{className:"lg:col-span-2",children:(0,t.jsxs)("div",{className:"card",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold mb-2",children:r.full_name}),(0,t.jsx)("p",{className:"text-xl text-gray-600",children:null===(e=r.category)||void 0===e?void 0:e.name})]}),r.is_verified&&(0,t.jsx)("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full",children:"✓ Verified"})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)(m.Z,{rating:r.rating_avg||0}),(0,t.jsxs)("p",{className:"text-gray-600 mt-2",children:[r.experience_years," years of experience"]})]}),r.portfolios&&r.portfolios.length>0&&(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Portfolio"}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:r.portfolios.map(e=>(0,t.jsx)("div",{className:"relative h-48",children:(0,t.jsx)(o(),{src:e.image_url,alt:"Portfolio",fill:!0,className:"object-cover rounded-lg"})},e.id))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Reviews"}),r.reviews&&r.reviews.length>0?(0,t.jsx)("div",{className:"space-y-4",children:r.reviews.map(e=>{var s;return(0,t.jsxs)("div",{className:"border-b pb-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold",children:null===(s=e.user)||void 0===s?void 0:s.full_name}),(0,t.jsx)(m.Z,{rating:e.rating})]}),(0,t.jsx)("span",{className:"text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()})]}),e.comment&&(0,t.jsx)("p",{className:"text-gray-700",children:e.comment})]},e.id)})}):(0,t.jsx)("p",{className:"text-gray-600",children:"No reviews yet"})]})]})}),(0,t.jsx)("div",{className:"lg:col-span-1",children:(0,t.jsxs)("div",{className:"card sticky top-4",children:[(0,t.jsx)("h3",{className:"text-xl font-bold mb-4",children:"Contact Provider"}),r.is_verified?(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("button",{onClick:()=>C("call"),className:"btn-primary w-full",children:"\uD83D\uDCDE Call Now"}),(0,t.jsx)("button",{onClick:()=>C("whatsapp"),className:"btn-secondary w-full",children:"\uD83D\uDCAC WhatsApp"}),p&&(0,t.jsx)("div",{className:"mt-6 pt-6 border-t",children:j?(0,t.jsxs)("form",{onSubmit:k,className:"space-y-4",children:[(0,t.jsx)("h4",{className:"font-semibold",children:"Leave a Review"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Rating"}),(0,t.jsxs)("select",{value:b.rating,onChange:e=>N({...b,rating:parseInt(e.target.value)}),className:"input-field",required:!0,children:[(0,t.jsx)("option",{value:"5",children:"5 - Excellent"}),(0,t.jsx)("option",{value:"4",children:"4 - Good"}),(0,t.jsx)("option",{value:"3",children:"3 - Average"}),(0,t.jsx)("option",{value:"2",children:"2 - Poor"}),(0,t.jsx)("option",{value:"1",children:"1 - Very Poor"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Comment (optional)"}),(0,t.jsx)("textarea",{value:b.comment,onChange:e=>N({...b,comment:e.target.value}),className:"input-field",rows:"4",placeholder:"Share your experience..."})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{type:"submit",disabled:g,className:"btn-primary flex-1",children:g?"Submitting...":"Submit Review"}),(0,t.jsx)("button",{type:"button",onClick:()=>f(!1),className:"btn-secondary",children:"Cancel"})]})]}):(0,t.jsx)("button",{onClick:()=>f(!0),className:"btn-primary w-full",children:"✍️ Leave a Review"})})]}):(0,t.jsx)("p",{className:"text-gray-600",children:"This provider is pending verification and cannot be contacted yet."})]})})]})})]}):(0,t.jsx)(d.Z,{children:(0,t.jsx)("div",{className:"container mx-auto px-4 py-8 text-center",children:"Provider not found"})})}}},function(e){e.O(0,[173,675,804,774,888,179],function(){return e(e.s=6650)}),_N_E=e.O()}]);